<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Security HTTP Response Headers :: Spring</title>
    <meta name="generator" content="Antora 3.0.0-alpha.6">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
<link rel="stylesheet" href="../../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../../_/css/vendor/docsearch.min.css">
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->    <script>var uiRootPath = '../../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../..">Spring</a>
      <div class="navbar-item">
        <input id="search-input" type="text" placeholder="Search docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Why Spring</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Reactive</a>
            <a class="navbar-item" href="#">Event Driven</a>
            <a class="navbar-item" href="#">Cloud</a>
            <a class="navbar-item" href="#">Web Applications</a>
            <a class="navbar-item" href="#">Serverless</a>
            <a class="navbar-item" href="#">Batch</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Learn</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Overview</a>
            <a class="navbar-item" href="#">Quickstart</a>
            <a class="navbar-item" href="#">Guides</a>
            <a class="navbar-item" href="#">Blog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Projects</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Overview</a>
            <a class="navbar-item" href="#">Spring Boot</a>
            <a class="navbar-item" href="#">...</a>
          </div>
        </div>

        <a class="navbar-item" href="#">Training</a>
        <a class="navbar-item" href="#">Support</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Overview</a>
            <a class="navbar-item" href="#">Events</a>
            <a class="navbar-item" href="#">Team</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="security" data-version="5.6">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Spring Security</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Overview</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../community.html">Community</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../whats-new.html">What&#8217;s New</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../getting-spring-security.html">Getting Spring Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Features</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authentication/index.html">Authentication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="index.html">Protection Against Exploits</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../modules.html">Project Modules &amp; Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../samples.html">Samples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Servlet Applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/hello/index.html">Hello Spring Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/architecture/index.html">The Big Picture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Authentication</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/architecture/index.html">Authentication Architecture</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../servlet/authentication/unpwd/index.html">Username/Password</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reading Username/Password</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/form.html">Form</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/basic.html">Basic</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/digest.html">Digest</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Password Storage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/in-memory.html">In Memory</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/jdbc.html">JDBC</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/user-details.html">UserDetails</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/user-details-service.html">UserDetailsService</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/password-encoder.html">PasswordEncoder</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/dao-authentication-provider.html">DaoAuthenticationProvider</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../../servlet/authentication/unpwd/ldap.html">LDAP</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/session-management.html">Session Management</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/rememberme.html">Remember Me</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/openid.html">OpenID</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/anonymous.html">Anonymous</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/preauth.html">Pre-Authentication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/jaas.html">JAAS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/cas.html">CAS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/x509.html">X509</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/runas.html">Run-As</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/logout.html">Logout</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authentication/events.html">Authentication Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Authorization</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authorization/architecture.html">Authorization Architecture</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authorization/authorize-requests.html">Authorize HTTP Requests</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authorization/expression-based.html">Expression-Based Access Control</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authorization/secure-objects.html">Secure Object Implementations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authorization/method-security.html">Method Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/authorization/acls.html">Domain Object Security ACLs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OAuth2</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/oauth2/oauth2-login.html">OAuth2 Log In</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/oauth2/oauth2-client.html">OAuth2 Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/oauth2/oauth2-resourceserver.html">OAuth2 Resource Server</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/saml2/index.html">SAML2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/exploits/index.html">Protection Against Exploits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/integrations/index.html">Integrations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/java-configuration/index.html">Java Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/kotlin-configuration/index.html">Kotlin Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../servlet/namespace/index.html">Namespace Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/test/index.html">Testing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/crypto/index.html">Cryptography</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../servlet/appendix/index.html">Appendix</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reactive Applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/webflux.html">WebFlux Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/exploits/index.html">Protection Against Exploits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/oauth2/index.html">OAuth2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/registered-oauth2-authorized-client.html">@RegisteredOAuth2AuthorizedClient</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/x509.html">X.509 Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/webclient.html">WebClient</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/method.html">EnableReactiveMethodSecurity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/cors.html">CORS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/test.html">Testing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../reactive/rsocket.html">RSocket</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore" style="display: none;">
  <div class="context">
    <span class="title">Spring Security</span>
    <span class="version">5.6</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../framework/5.3/index.html">Spring Framework</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../framework/5.3/index.html">5.3</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../../6/overview/prerequisites.html">Spring Security</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../6/overview/prerequisites.html">6</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">5.6</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="" role="navigation">
<button class="nav-toggle"></button>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Security HTTP Response Headers</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This portion of the documentation discusses the general topic of Security HTTP Response Headers.
Refer to the relevant sections for specific information on Security HTTP Response Headers <a href="#servlet-headers">servlet</a> and <a href="#webflux-headers">WebFlux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are many <a href="https://owasp.org/www-project-secure-headers/#div-headers">HTTP response headers</a> that can be used to increase the security of web applications.
This section is dedicated to the various HTTP response headers that Spring Security provides explicit support for.
If necessary, Spring Security can also be configured to provide <a href="#headers-custom">custom headers</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-default"><a class="anchor" href="#headers-default"></a>Default Security Headers</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to customize the defaults for both <a href="#servlet-headers-default">servlet</a> and <a href="#webflux-headers-default">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Security provides a default set of security related HTTP response headers to provide secure defaults.</p>
</div>
<div class="paragraph">
<p>The default for Spring Security is to include the following headers:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Default Security HTTP Response Headers</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-http hljs" data-lang="http">Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Content-Type-Options: nosniff
Strict-Transport-Security: max-age=31536000 ; includeSubDomains
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Strict-Transport-Security is only added on HTTPS requests
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the defaults do not meet your needs, you can easily remove, modify, or add headers from these defaults.
For additional details on each of these headers, refer to the corresponding sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#headers-cache-control">Cache Control</a></p>
</li>
<li>
<p><a href="#headers-content-type-options">Content Type Options</a></p>
</li>
<li>
<p><a href="#headers-hsts">HTTP Strict Transport Security</a></p>
</li>
<li>
<p><a href="#headers-frame-options">X-Frame-Options</a></p>
</li>
<li>
<p><a href="#headers-xss-protection">X-XSS-Protection</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-cache-control"><a class="anchor" href="#headers-cache-control"></a>Cache Control</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to customize the defaults for both <a href="#servlet-headers-cache-control">servlet</a> and <a href="#webflux-headers-cache-control">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Security&#8217;s default is to disable caching to protect user&#8217;s content.</p>
</div>
<div class="paragraph">
<p>If a user authenticates to view sensitive information and then logs out, we don&#8217;t want a malicious user to be able to click the back button to view the sensitive information.
The cache control headers that are sent by default are:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Default Cache Control HTTP Response Headers</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In order to be secure by default, Spring Security adds these headers by default.
However, if your application provides its own cache control headers Spring Security will back out of the way.
This allows for applications to ensure that static resources like CSS and JavaScript can be cached.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-content-type-options"><a class="anchor" href="#headers-content-type-options"></a>Content Type Options</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to customize the defaults for both <a href="#servlet-headers-content-type-options">servlet</a> and <a href="#webflux-headers-content-type-options">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Historically browsers, including Internet Explorer, would try to guess the content type of a request using <a href="https://en.wikipedia.org/wiki/Content_sniffing">content sniffing</a>.
This allowed browsers to improve the user experience by guessing the content type on resources that had not specified the content type.
For example, if a browser encountered a JavaScript file that did not have the content type specified, it would be able to guess the content type and then run it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are many additional things one should do (i.e. only display the document in a distinct domain, ensure Content-Type header is set, sanitize the document, etc) when allowing content to be uploaded.
However, these measures are out of the scope of what Spring Security provides.
It is also important to point out when disabling content sniffing, you must specify the content type in order for things to work properly.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The problem with content sniffing is that this allowed malicious users to use polyglots (i.e. a file that is valid as multiple content types) to perform XSS attacks.
For example, some sites may allow users to submit a valid postscript document to a website and view it.
A malicious user might create a <a href="http://webblaze.cs.berkeley.edu/papers/barth-caballero-song.pdf">postscript document that is also a valid JavaScript file</a> and perform a XSS attack with it.</p>
</div>
<div class="paragraph">
<p>Spring Security disables content sniffing by default by adding the following header to HTTP responses:</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. nosniff HTTP Response Header</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-http hljs" data-lang="http">X-Content-Type-Options: nosniff</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-hsts"><a class="anchor" href="#headers-hsts"></a>HTTP Strict Transport Security (HSTS)</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to customize the defaults for both <a href="#servlet-headers-hsts">servlet</a> and <a href="#webflux-headers-hsts">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you type in your bank&#8217;s website, do you enter mybank.example.com or do you enter <a href="https://mybank.example.com" class="bare">https://mybank.example.com</a>?
If you omit the https protocol, you are potentially vulnerable to <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man in the Middle attacks</a>.
Even if the website performs a redirect to <a href="https://mybank.example.com" class="bare">https://mybank.example.com</a> a malicious user could intercept the initial HTTP request and manipulate the response (e.g. redirect to <a href="https://mibank.example.com" class="bare">https://mibank.example.com</a> and steal their credentials).</p>
</div>
<div class="paragraph">
<p>Many users omit the https protocol and this is why <a href="https://tools.ietf.org/html/rfc6797">HTTP Strict Transport Security (HSTS)</a> was created.
Once mybank.example.com is added as a <a href="https://tools.ietf.org/html/rfc6797#section-5.1">HSTS host</a>, a browser can know ahead of time that any request to mybank.example.com should be interpreted as <a href="https://mybank.example.com" class="bare">https://mybank.example.com</a>.
This greatly reduces the possibility of a Man in the Middle attack occurring.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In accordance with <a href="https://tools.ietf.org/html/rfc6797#section-7.2">RFC6797</a>, the HSTS header is only injected into HTTPS responses.
In order for the browser to acknowledge the header, the browser must first trust the CA that signed the SSL certificate used to make the connection (not just the SSL certificate).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One way for a site to be marked as a HSTS host is to have the host preloaded into the browser.
Another is to add the <code>Strict-Transport-Security</code> header to the response.
For example, Spring Security&#8217;s default behavior is to add the following header which instructs the browser to treat the domain as an HSTS host for a year (there are approximately 31536000 seconds in a year):</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Strict Transport Security HTTP Response Header</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Strict-Transport-Security: max-age=31536000 ; includeSubDomains ; preload</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The optional <code>includeSubDomains</code> directive instructs the browser that subdomains (e.g. secure.mybank.example.com) should also be treated as an HSTS domain.</p>
</div>
<div class="paragraph">
<p>The optional <code>preload</code> directive instructs the browser that domain should be preloaded in browser as HSTS domain.
For more details on HSTS preload please see <a href="https://hstspreload.org" class="bare">https://hstspreload.org</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-hpkp"><a class="anchor" href="#headers-hpkp"></a>HTTP Public Key Pinning (HPKP)</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to remain passive Spring Security still provides <a href="#servlet-headers-hpkp">support for HPKP in servlet environments</a>, but for the reasons listed above HPKP is no longer recommended by the security team.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning">HTTP Public Key Pinning (HPKP)</a> specifies to a web client which public key to use with certain web server to prevent Man in the Middle (MITM) attacks with forged certificates.
When used correctly, HPKP could add additional layers of protection against compromised certificates.
However, due to the complexity of HPKP many experts no longer recommend using it and <a href="https://www.chromestatus.com/feature/5903385005916160">Chrome has even removed support</a> for it.</p>
</div>
<div id="headers-hpkp-deprecated" class="paragraph">
<p>For additional details around why HPKP is no longer recommended read <a href="https://blog.qualys.com/ssllabs/2016/09/06/is-http-public-key-pinning-dead">
Is HTTP Public Key Pinning Dead?</a> and <a href="https://scotthelme.co.uk/im-giving-up-on-hpkp/">I&#8217;m giving up on HPKP</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-frame-options"><a class="anchor" href="#headers-frame-options"></a>X-Frame-Options</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to customize the defaults for both <a href="#servlet-headers-frame-options">servlet</a> and <a href="#webflux-headers-frame-options">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Allowing your website to be added to a frame can be a security issue.
For example, using clever CSS styling users could be tricked into clicking on something that they were not intending.
For example, a user that is logged into their bank might click a button that grants access to other users.
This sort of attack is known as <a href="https://en.wikipedia.org/wiki/Clickjacking">Clickjacking</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Another modern approach to dealing with clickjacking is to use <a href="#headers-csp">Content Security Policy (CSP)</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are a number ways to mitigate clickjacking attacks.
For example, to protect legacy browsers from clickjacking attacks you can use <a href="https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet#Best-for-now_Legacy_Browser_Frame_Breaking_Script">frame breaking code</a>.
While not perfect, the frame breaking code is the best you can do for the legacy browsers.</p>
</div>
<div class="paragraph">
<p>A more modern approach to address clickjacking is to use <a href="https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options">X-Frame-Options</a> header.
By default Spring Security disables rendering pages within an iframe using with the following header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">X-Frame-Options: DENY</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-xss-protection"><a class="anchor" href="#headers-xss-protection"></a>X-XSS-Protection</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to customize the defaults for both <a href="#servlet-headers-xss-protection">servlet</a> and <a href="#webflux-headers-xss-protection">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some browsers have built in support for filtering out <a href="https://www.owasp.org/index.php/Testing_for_Reflected_Cross_site_scripting_(OWASP-DV-001)">reflected XSS attacks</a>.
This is by no means foolproof, but does assist in XSS protection.</p>
</div>
<div class="paragraph">
<p>The filtering is typically enabled by default, so adding the header typically just ensures it is enabled and instructs the browser what to do when a XSS attack is detected.
For example, the filter might try to change the content in the least invasive way to still render everything.
At times, this type of replacement can become a <a href="https://hackademix.net/2009/11/21/ies-xss-filter-creates-xss-vulnerabilities/">XSS vulnerability in itself</a>.
Instead, it is best to block the content rather than attempt to fix it.
By default Spring Security blocks the content using the following header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">X-XSS-Protection: 1; mode=block</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-csp"><a class="anchor" href="#headers-csp"></a>Content Security Policy (CSP)</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to configure both <a href="#servlet-headers-csp">servlet</a> and <a href="#webflux-headers-csp">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/CSP2/">Content Security Policy (CSP)</a> is a mechanism that web applications can leverage to mitigate content injection vulnerabilities, such as cross-site scripting (XSS).
CSP is a declarative policy that provides a facility for web application authors to declare and ultimately inform the client (user-agent) about the sources from which the web application expects to load resources.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Content Security Policy is not intended to solve all content injection vulnerabilities.
Instead, CSP can be leveraged to help reduce the harm caused by content injection attacks.
As a first line of defense, web application authors should validate their input and encode their output.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A web application may employ the use of CSP by including one of the following HTTP headers in the response:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Content-Security-Policy</code></p>
</li>
<li>
<p><code>Content-Security-Policy-Report-Only</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these headers are used as a mechanism to deliver a security policy to the client.
A security policy contains a set of security policy directives, each responsible for declaring the restrictions for a particular resource representation.</p>
</div>
<div class="paragraph">
<p>For example, a web application can declare that it expects to load scripts from specific, trusted sources, by including the following header in the response:</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Content Security Policy Example</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Content-Security-Policy: script-src https://trustedscripts.example.com</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>An attempt to load a script from another source other than what is declared in the <code>script-src</code> directive will be blocked by the user-agent.
Additionally, if the <a href="https://www.w3.org/TR/CSP2/#directive-report-uri">report-uri</a> directive is declared in the security policy, then the violation will be reported by the user-agent to the declared URL.</p>
</div>
<div class="paragraph">
<p>For example, if a web application violates the declared security policy, the following response header will instruct the user-agent to send violation reports to the URL specified in the policy&#8217;s <code>report-uri</code> directive.</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Content Security Policy with report-uri</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Content-Security-Policy: script-src https://trustedscripts.example.com; report-uri /csp-report-endpoint/</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/CSP2/#violation-reports">Violation reports</a> are standard JSON structures that can be captured either by the web application&#8217;s own API or by a publicly hosted CSP violation reporting service, such as, <a href="https://report-uri.com/" class="bare">https://report-uri.com/</a>.</p>
</div>
<div class="paragraph">
<p>The <code>Content-Security-Policy-Report-Only</code> header provides the capability for web application authors and administrators to monitor security policies, rather than enforce them.
This header is typically used when experimenting and/or developing security policies for a site.
When a policy is deemed effective, it can be enforced by using the <code>Content-Security-Policy</code> header field instead.</p>
</div>
<div class="paragraph">
<p>Given the following response header, the policy declares that scripts may be loaded from one of two possible sources.</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Content Security Policy Report Only</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Content-Security-Policy-Report-Only: script-src 'self' https://trustedscripts.example.com; report-uri /csp-report-endpoint/</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the site violates this policy, by attempting to load a script from <em>evil.com</em>, the user-agent will send a violation report to the declared URL specified by the <em>report-uri</em> directive, but still allow the violating resource to load nevertheless.</p>
</div>
<div class="paragraph">
<p>Applying Content Security Policy to a web application is often a non-trivial undertaking.
The following resources may provide further assistance in developing effective security policies for your site.</p>
</div>
<div class="paragraph">
<p><a href="https://www.html5rocks.com/en/tutorials/security/content-security-policy/">An Introduction to Content Security Policy</a></p>
</div>
<div class="paragraph">
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP">CSP Guide - Mozilla Developer Network</a></p>
</div>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/CSP2/">W3C Candidate Recommendation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-referrer"><a class="anchor" href="#headers-referrer"></a>Referrer Policy</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to configure both <a href="#servlet-headers-referrer">servlet</a> and <a href="#webflux-headers-referrer">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/referrer-policy">Referrer Policy</a> is a mechanism that web applications can leverage to manage the referrer field, which contains the last
page the user was on.</p>
</div>
<div class="paragraph">
<p>Spring Security&#8217;s approach is to use <a href="https://www.w3.org/TR/referrer-policy/">Referrer Policy</a> header, which provides different <a href="https://www.w3.org/TR/referrer-policy/#referrer-policies">policies</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. Referrer Policy Example</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Referrer-Policy: same-origin</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The Referrer-Policy response header instructs the browser to let the destination knows the source where the user was previously.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-feature"><a class="anchor" href="#headers-feature"></a>Feature Policy</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to configure both <a href="#servlet-headers-feature">servlet</a> and <a href="#webflux-headers-feature">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://wicg.github.io/feature-policy/">Feature Policy</a> is a mechanism that allows web developers to selectively enable, disable, and modify the behavior of certain APIs and web features in the browser.</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. Feature Policy Example</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Feature-Policy: geolocation 'self'</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With Feature Policy, developers can opt-in to a set of "policies" for the browser to enforce on specific features used throughout your site.
These policies restrict what APIs the site can access or modify the browser&#8217;s default behavior for certain features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-permissions"><a class="anchor" href="#headers-permissions"></a>Permissions Policy</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to configure both <a href="#servlet-headers-permissions">servlet</a> and <a href="#webflux-headers-permissions">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://w3c.github.io/webappsec-permissions-policy/">Permissions Policy</a> is a mechanism that allows web developers to selectively enable, disable, and modify the behavior of certain APIs and web features in the browser.</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. Permissions Policy Example</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Permissions-Policy: geolocation=(self)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With Permissions Policy, developers can opt-in to a set of "policies" for the browser to enforce on specific features used throughout your site.
These policies restrict what APIs the site can access or modify the browser&#8217;s default behavior for certain features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-clear-site-data"><a class="anchor" href="#headers-clear-site-data"></a>Clear Site Data</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to configure both <a href="#servlet-headers-clear-site-data">servlet</a> and <a href="#webflux-headers-clear-site-data">webflux</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/clear-site-data/">Clear Site Data</a> is a mechanism by which any browser-side data - cookies, local storage, and the like - can be removed when an HTTP response contains this header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Clear-Site-Data: "cache", "cookies", "storage", "executionContexts"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a nice clean-up action to perform on logout.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers-custom"><a class="anchor" href="#headers-custom"></a>Custom Headers</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the relevant sections to see how to configure both <a href="#servlet-headers-custom">servlet</a> based applications.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Security has mechanisms to make it convenient to add the more common security headers to your application.
However, it also provides hooks to enable adding custom headers.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/tabs.js"></script>
<script src="../../../../../_/js/vendor/docsearch.min.js"></script>
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
<script>
docsearch({
  appId: 'L0TI0XV6RD',
  apiKey: '278da59d0706716556405ce7a28ba297',
  indexName: 'dev_spring',
  inputSelector: '#search-input',
  algoliaOptions: { hitsPerPage: 10 }
})
</script>  </body>
</html>
